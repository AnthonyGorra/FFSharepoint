 <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>First Financial SharePoint Access</title>
      <style>
          body {
              font-family: Arial, sans-serif;
              line-height: 1.6;
              margin: 0;
              padding: 0;
              color: #333;
          }
          .container {
              width: 95%;
              margin: 20px auto;
          }
          h1 {
              text-align: center;
              color: #003366;
              margin-bottom: 30px;
          }
          .view-toggle {
              display: flex;
              justify-content: center;
              margin-bottom: 20px;
          }
          .view-button {
              background: #003366;
              color: white;
              border: none;
              padding: 10px 20px;
              margin: 0 10px;
              cursor: pointer;
              border-radius: 4px;
              font-size: 16px;
          }
          .view-button.active {
              background: #00a8e8;
          }
          .tabs {
              display: flex;
              flex-wrap: wrap;
              margin-bottom: 10px;
              border-bottom: 1px solid #ddd;
          }
          .tab-button {
              background: #f1f1f1;
              border: none;
              padding: 10px 15px;
              cursor: pointer;
              margin-right: 5px;
              margin-bottom: 5px;
              border-radius: 5px 5px 0 0;
              transition: background-color 0.3s;
          }
          .tab-button:hover {
              background-color: #ddd;
          }
          .tab-button.active {
              background-color: #003366;
              color: white;
          }
          .tab-content {
              display: none;
              padding: 15px;
              border: 1px solid #ddd;
              border-top: none;
              animation: fadeIn 0.5s;
          }
          @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
          }
          .user-list, .site-list {
              column-count: 3;
              column-gap: 20px;
          }
          .user-item, .site-item {
              margin-bottom: 5px;
              break-inside: avoid;
              cursor: pointer;
              position: relative;
          }
          .user-item:hover, .site-item:hover {
              color: #0056b3;
              text-decoration: underline;
          }
          .search-container {
              margin-bottom: 20px;
          }
          #searchInput {
              width: 100%;
              padding: 10px;
              font-size: 16px;
              border: 1px solid #ddd;
              border-radius: 4px;
          }
          .filter-buttons {
              margin: 10px 0;
          }
          .filter-button {
              background: #003366;
              color: white;
              border: none;
              padding: 8px 15px;
              margin-right: 10px;
              cursor: pointer;
              border-radius: 4px;
          }
          .view-container {
              display: none;
          }
          .modal {
              position: fixed;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              background-color: white;
              padding: 20px;
              border-radius: 5px;
              box-shadow: 0 0 10px rgba(0,0,0,0.3);
              z-index: 1000;
              max-width: 80%;
              max-height: 80%;
              overflow: auto;
          }
          .overlay {
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background-color: rgba(0,0,0,0.5);
              z-index: 999;
          }
          .close-button {
              padding: 10px 20px;
              background-color: #003366;
              color: white;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              margin-top: 10px;
          }
          .highlight-buttons {
              display: flex;
              margin: 10px 0;
          }
          .highlight-button {
              padding: 5px 10px;
              margin-right: 10px;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              font-weight: bold;
          }
          .highlight-red {
              background-color: #ff6b6b;
              color: white;
          }
          .highlight-yellow {
              background-color: #ffd43b;
              color: black;
          }
          .clear-highlight {
              background-color: #f1f1f1;
              color: #333;
          }
          .add-note {
              background-color: #4dabf7;
              color: white;
          }
          .show-notes {
              background-color: #228be6;
              color: white;
          }
          .annotation-button {
              position: fixed;
              bottom: 20px;
              right: 20px;
              background-color: #12b886;
              color: white;
              border: none;
              border-radius: 50%;
              width: 60px;
              height: 60px;
              font-size: 24px;
              cursor: pointer;
              box-shadow: 0 2px 5px rgba(0,0,0,0.2);
              z-index: 900;
          }
          .highlight-red-bg {
              background-color: #ffcccb !important;
          }
          .highlight-yellow-bg {
              background-color: #ffffcc !important;
          }
          .note-icon {
              display: inline-block;
              width: 16px;
              height: 16px;
              background-color: #4dabf7;
              border-radius: 50%;
              margin-left: 5px;
              cursor: pointer;
          }
          .note-container {
              position: absolute;
              background-color: #fff;
              border: 1px solid #ddd;
              padding: 10px;
              border-radius: 4px;
              box-shadow: 0 2px 5px rgba(0,0,0,0.2);
              z-index: 100;
              width: 200px;
              top: 0;
              right: -220px;
          }
          .note-textarea {
              width: 100%;
              min-height: 100px;
              margin-bottom: 5px;
          }
          .floating-note {
              position: absolute;
              background-color: #fff9db;
              border: 1px solid #fcc419;
              padding: 10px;
              border-radius: 4px;
              box-shadow: 0 2px 5px rgba(0,0,0,0.2);
              z-index: 100;
              width: 200px;
              min-height: 100px;
              resize: both;
              overflow: auto;
          }
          .floating-note-header {
              padding: 5px;
              background-color: #fcc419;
              margin: -10px -10px 10px -10px;
              border-radius: 4px 4px 0 0;
              cursor: move;
              display: flex;
              justify-content: space-between;
          }
          .note-close {
              cursor: pointer;
              font-weight: bold;
          }
          .note-content {
              min-height: 60px;
          }
          @media (max-width: 768px) {
              .user-list, .site-list {
                  column-count: 1;
              }
          }
      </style>
  </head>
  <body>
      <div class="container">
          <h1>First Financial SharePoint Access</h1>

          <div class="view-toggle">
              <button class="view-button active" id="siteViewButton">Site View</button>
              <button class="view-button" id="userViewButton">User View</button>
          </div>

          <div class="search-container">
              <input type="text" id="searchInput" placeholder="Search for users or sites...">
              <div class="filter-buttons">
                  <button class="filter-button" onclick="resetView()">Reset View</button>
              </div>
          </div>

          <div class="highlight-buttons">
              <button class="highlight-button highlight-red" onclick="setHighlightMode('red')">Highlight Red</button>
              <button class="highlight-button highlight-yellow" onclick="setHighlightMode('yellow')">Highlight Yellow</button>
              <button class="highlight-button clear-highlight" onclick="setHighlightMode('clear')">Clear Highlight</button>
              <button class="highlight-button add-note" onclick="toggleAddNoteMode()">Add Note</button>
              <button class="highlight-button show-notes" onclick="toggleAllNotes()">Show/Hide All Notes</button>
          </div>

          <!-- Site View Container -->
          <div class="view-container" id="siteViewContainer" style="display:block;">
              <div class="tabs" id="siteTabsContainer">
                  <!-- Site tab buttons will be inserted here -->
              </div>

              <div id="siteTabContents">
                  <!-- Site tab contents will be inserted here -->
              </div>
          </div>

          <!-- User View Container -->
          <div class="view-container" id="userViewContainer">
              <div class="tabs" id="userTabsContainer">
                  <!-- User tab buttons will be inserted here -->
              </div>

              <div id="userTabContents">
                  <!-- User tab contents will be inserted here -->
              </div>
          </div>
      </div>

      <button class="annotation-button" id="annotationButton" title="Add floating note">+</button>

      <script>
          // Data structure with site access information
          const siteAccess = {
              "Intranet": [
                  "Aaron James", "Aaron Walshe", "Aashna Patel", "Abigail Gunarso", "Adam Ezerins",
                  "Adela Ngai", "Adrian Pelligra", "Ali Smith", "Aljeanette Arenilla", "Amelia Rogers",
                  "Amy Clarke", "Amy Ryczel", "Ana-Silvia Rivera", "Andrew Perks", "Andrew Shavikin",
                  "Angus Pond", "Annie Nguyen", "Annie Pruys", "Anthony Dhillon", "Anthony Gorra",
                  "Anthony Kapetanovic", "Avery Liu", "Avneet Dhindsa", "Barry Zeldenryk", "Belinda Li On Wing",
                  "Ben Moyle", "Ben Rossi", "Ben Traficante", "Bernard O'Connor", "Bookkeeper 3",
                  "Brad Jackson", "Brad Tucker", "Brendan Smith", "Brenton Ebinger", "Brylie Curran",
                  "Cameron Santomartino", "Charlee Geddis", "Charlene Sim", "Chester Ramos", "Chris Crough",
                  "Chris Kapetanovic", "Chris Pomaroff", "Chris White", "Chris Willaton", "Christian Ghersi",
                  "Christine Bau", "Christine Dorig", "Christy Kosasih", "Dana Mihajlovic", "Dania Sin",
                  "Daniel Basic", "Daniel Iturralde", "Daniel Pollock", "Daniel Smith", "Daryl Greenwood",
                  "David Howell", "David Jackson", "David Pitt", "David Studley", "Dimitri Poutakidis",
                  "Dionysia Catic", "Duncan", "Duncan Logie", "Dylan Hart", "Edrian Damondamon",
                  "Elesha Williams", "Emily Cole", "Emily Still", "Emmanuel Casquejo", "Erona Anore",
                  "Esha Desai", "Fiona Tobin", "FIRST FINANCIAL PTY LTD", "Gabriella Loschiavo",
                  "Gavin Colosimo", "Geoff Greetham", "George Katrantzis", "Georgia Caddy", "Grace Robinson",
                  "Graeme Quinlan", "Greg Test", "Greig Barrow", "Gwynn Kijkanakorn", "hanin",
                  "Harley Leslie", "Harry Terry", "Hayden Pynappels (Admin)", "Hayley Wong", "Helen",
                  "Helen He", "Husnia Noori", "Ilana Donde", "IT Services", "Iuliia Strygunova",
                  "Jack Dunn", "Jackie Cook", "Jaime Duckworth", "James Birrell", "James Bonasera",
                  "James Grixti", "James Wrigley", "Jan Andersen", "Jan Anderson", "Jane Zhou",
                  "Janine Orbeta", "Jarryd Gleeson", "Jarryd Gleeson (Admin)", "Jason Croft", "Jason Li",
                  "Jason Rawlins", "Jeanne Stephens", "Jemuel Magtalas", "Jennifer Youkhana", "Jessica Farah",
                  "Jillian Creek", "Jimmy Truong", "Jo Zhao", "Joe Akiki", "Joel Gleeson",
                  "John Gregory", "John Kypreos", "Jonathan Henderson", "Joseph Tolich", "Josh Ciccarone",
                  "Josh Scipione", "Joshua Bielik", "Julia Reid", "Julian Manning", "Julie Curnow",
                  "Karen Horta", "Karen Kung", "Karen Perfecto", "Kate Anderson", "Kate Schell",
                  "Katie Stevens", "Kavita Singh", "Kerri Engstrom", "Kianna Huangzhao", "Kim Nguyen",
                  "Lauretta Dixon", "Leah Campagnolo", "Lisa Palmer", "Lucy Lim", "Luke Broxton",
                  "Lylyna Im", "Madeline Fernando", "Manu Fernando", "Marc Wearne", "Maree Rykers",
                  "Maria Oledan", "Mariel ChristineBalatayo", "Marriel Ocharon", "Marshall Owen", "Mary Delzoppo",
                  "Matt Raponi", "Matthew Benic", "Matthew Calderbank", "Matthew Magee", "Matthew Pecipajkovski",
                  "Matthew Raponi", "Mattias Rose", "Meeting Room Laptop", "Mei Xue", "Michael Kemp",
                  "Michele Kennedy", "Mitchell Calleja", "Naomi Lohanatha", "Nash Hove", "Natalie Vienet",
                  "Nathaniel Johnston", "Navneet Sandhu", "Neetu Gandhi", "Nick Donato", "Nick Thomas",
                  "Nickolas Reissis", "Nicole Gullone", "Nicole Peixoto", "Nigel Judd", "NitroLicences",
                  "Nuwan Rodrigo", "Oliver Cahill", "Omar Manasfi", "ONGC Systems", "ongc test user",
                  "Pablo Vilela", "Patrick Deltiglio", "Paul Cupic", "Paul Seidl", "Peta Tobin",
                  "Petar Cvetkovski", "Peter White", "Pnet test", "PNET Test", "Power Automate",
                  "Rachel Douglas", "Ray Sabarillo", "Rebecca Ruck", "Rebekah Jacob", "Receptionist FirstFinancial",
                  "Reg Adams", "Renae Vercoe", "Renee Sutton", "Revenue", "Revenue2",
                  "Richard Gourlay", "Rob Petrie", "Robert Fletcher", "Robert Makdissi", "Roel Burghouwt",
                  "Roi Turado", "Ruben Bock", "Ryan Keenan", "Ryan McLean", "Ryan Sgarioto",
                  "Samantha James", "Sammi Gao", "Sarah Gates", "Sarah Magnaye", "Sarah Nguyen",
                  "Savita Dhillon", "Scan Tech", "Scott Milligan", "Sean Curran", "Sera Varea",
                  "Shaery Mae Magno Pato", "Shanaine Daan", "Sharelle Hudson", "Sharon McAuslan", "shaun",
                  "Shaun Albert", "Shauna Broes", "Shayne Francis", "Sim Marsh", "Stefanie Falleti",
                  "Sugul Rasakulasingam", "Telesia Szegedi", "temp pnet", "Test", "test test",
                  "Tim Hunter", "Tracey Zamora", "Vea Gunawan", "Vincent Aw", "Vivek Mishra",
                  "Welkin Admin", "William Hume", "witadmin", "Yasmin Gibson-Hutton", "Zac McGlone",
                  "0#.f|membership|user_9f5adf1ee11740289330f05eb6cb83fe@welkinit.com.au",
                  "0#.f|membership|user_c42155873ddb44f78567f763be88d3c9@welkinit.com.au",
                  "0#.f|membership|user_d749a72189784862b60888fbe68f8faa@welkinit.com.au",
                  "hayden.pynappels@pnet.com.au",
                  "marshall@akambofg.com",
                  "rob@akambofg.com",
                  "godwin.rapinett@vative.com.au"
              ],
              "AAGroup": [
                  "Adam Ezerins", "Amy Clarke", "Andrew Shavikin", "Brendan Smith", "Christy Kosasih",
                  "Daniel Smith", "FIRST FINANCIAL PTY LTD", "Harley Leslie", "Hayley Wong",
                  "James Grixti", "Jo Zhao", "Joel Gleeson", "Kate Schell", "Lisa Palmer",
                  "Matthew Benic", "Matthew Magee", "Michele Kennedy", "Nathaniel Johnston",
                  "Nick Donato", "Nick Thomas", "Paul Cupic", "Paul Seidl", "Rebecca Ruck",
                  "Ryan Sgarioto", "Sugul Rasakulasingam", "Vivek Mishra", "Welkin Admin", "William Hume"
              ],
              "Accordius": [
                  "Aimee Calaquian", "Andrew Perks", "aperks", "Brylie Curran", "Chris Kapetanovic",
                  "FIRST FINANCIAL PTY LTD", "Geoff Greetham", "Jackie Cook", "Jane Zhou",
                  "Jillian Creek", "Karen Horta", "Lauretta Dixon", "Lylyna Im", "Neetu Gandhi",
                  "Welkin Admin"
              ],
              "AccountsAPAAdvice": ["FIRST FINANCIAL PTY LTD"],
              "AdHocGeneral": ["Nick Thomas", "Sera Varea"],
              "admin-ops": [
                  "Aaron James", "Aaron Walshe", "Aashna Patel", "Adam Ezerins", "Adela Ngai",
                  "Adrian Pelligra", "Ali Smith", "Amelia Rogers", "Amy Clarke", "Andrew Perks",
                  "Annie Nguyen", "Annie Pruys", "Anthony Dhillon", "Anthony Gorra", "Anthony Kapetanovic",
                  "Avneet Dhindsa", "Ben Rossi", "Bernard O'Connor", "Bookkeeper 3", "BookKeeper2",
                  "Brad Jackson", "Brad Tucker", "Brendan Smith", "Brenton Ebinger", "Brylie Curran",
                  "Cameron Santomartino", "Charlene Sim", "Chester Ramos", "Chris Crough", "Chris Kapetanovic",
                  "Chris Willaton", "Christian Ghersi", "claireg@whittleskok.com.au", "Dana Mihajlovic",
                  "Dania Sin", "Daniel Basic", "Daniel Pollock", "Daniel Smith", "David Howell",
                  "David Jackson", "David Pitt", "Dimitri Poutakidis", "Dionysia Catic", "Duncan Logie",
                  "Elesha Williams", "Erona Anore", "Esha Desai", "Fiona Tobin", "FIRST FINANCIAL PTY LTD",
                  "Gabriella Loschiavo", "Gavin Colosimo", "gaylew@whittleskok.com.au", "george",
                  "George Katrantzis", "Gina Melis", "Gosia Chapman", "Graeme Quinlan", "Greig Barrow",
                  "Gwynn Kijkanakorn", "Helen He", "info@rebeccataylor.com.au", "Jackie Cook", "James Birrell",
                  "James Bonasera", "James Grixti", "James Wrigley", "Jane Zhou", "Jason Rawlins",
                  "Jessica Farah", "Jillian Creek", "Jimmy Truong", "Jo Zhao", "Joe Akiki",
                  "Joel Gleeson", "Jonathan Henderson", "Josh Ciccarone", "Josh Scipione", "Joshua Bielik",
                  "Karen Horta", "Karen Perfecto", "Katie Stevens", "kelliep@whittleskok.com.au",
                  "Lauretta Dixon", "Lisa Palmer", "Luke Broxton", "Lylyna Im", "Marc Wearne",
                  "maree", "Maree Rykers", "Maria Oledan", "Marriel Ocharon", "Marshall Owen",
                  "Matthew Benic", "Matthew Calderbank", "Mattias Rose", "Mei Xue", "Melissa Glover",
                  "Michael Kemp", "Mitchell Calleja", "Nash Hove", "Natalie Vienet", "Nathaniel Johnston",
                  "Neetu Gandhi", "Nick Donato", "Nick Thomas", "Nickolas Reissis", "Nicole Gullone",
                  "Nigel Judd", "Pablo Vilela", "Patrick Deltiglio", "Paul Cupic", "Peta Tobin",
                  "Peter White", "philippac@whittleskok.com.au", "Rebecca", "Rebecca Ruck", "Revenue",
                  "Revenue2", "Rob Petrie", "Robert Makdissi", "Roel Burghouwt", "Ruben Bock",
                  "Ryan McLean", "Ryan Sgarioto", "Sarah Nguyen", "Scott Milligan", "Sharelle Hudson",
                  "Sharon McAuslan", "Shaun Albert", "Sim Marsh", "Stefanie Falleti", "Telesia Szegedi",
                  "Tim Chisholm", "Tracey Zamora", "Vincent Aw", "Welkin Admin", "Zac McGlone"
              ],
              "AdminAPAAdvice": ["FIRST FINANCIAL PTY LTD"],
              "advice-hub": ["FIRST FINANCIAL PTY LTD"],
              "advice-hub2": ["Natalie Vienet"],
              "AdviceRewardReview": ["FIRST FINANCIAL PTY LTD"],
              "AdviceRewardReview2": ["Jonathan Henderson", "Peter White"],
              "Adviser-catch-ups-intranet-access": [
                  "Amy Clarke", "Dania Sin", "FIRST FINANCIAL PTY LTD", "Gavin Colosimo",
                  "Graeme Quinlan", "Roel Burghouwt"
              ],
              "advisorteam": ["FIRST FINANCIAL PTY LTD"],
              "afg-team": [
                  "Anthony Kapetanovic", "Avneet Dhindsa", "Brylie Curran", "Dimitri Poutakidis",
                  "FIRST FINANCIAL PTY LTD", "Gosia Chapman", "Gwynn Kijkanakorn", "Jason Rawlins",
                  "Jimmy Truong", "Katie Stevens", "Lucy Lim", "Maree Rykers", "Mitchell Calleja",
                  "Peta Tobin", "Peter White", "Rob Petrie", "Ruben Bock", "Scott Milligan", "Tracey Zamora"
              ],
              "AFGManagement": [
                  "Anthony Kapetanovic", "Chris Willaton", "David Pitt", "FIRST FINANCIAL PTY LTD",
                  "Jane Zhou", "Jason Rawlins", "Jillian", "Jillian Creek", "Joe Akiki",
                  "Matthew Calderbank", "Rob Petrie", "Welkin Admin"
              ],
              "AFGManagement9": ["FIRST FINANCIAL PTY LTD", "Welkin Admin"],
              "AFGTeam": [
                  "Aaron James", "Aaron Walshe", "Aashna Patel", "Abigail Gunarso", "Adrian Pelligra",
                  "Andrew Perks", "Annie Pruys", "Anthony Kapetanovic", "Avneet Dhindsa", "Ben Moyle",
                  "Bernard O'Connor", "Brenton Ebinger", "Brylie Curran", "Chris Kapetanovic",
                  "Christian Ghersi", "Daniel Basic", "Daniel Iturralde", "David Howell", "David Pitt",
                  "Dimitri Poutakidis", "Duncan Logie", "FIRST FINANCIAL PTY LTD", "Gabriella Loschiavo",
                  "Gavin Colosimo", "Geoff Greetham", "George Katrantzis", "Grace Robinson", "Graeme Quinlan",
                  "Greig Barrow", "Gwynn Kijkanakorn", "Helen He", "Jackie Cook", "James Birrell",
                  "Jane Zhou", "Jason Rawlins", "Jillian Creek", "Jimmy Truong", "Joe Akiki",
                  "Jonathan Henderson", "Josh Scipione", "Katie Stevens", "Lauretta Dixon", "Lisa Palmer",
                  "Luke Broxton", "Maree Rykers", "Marshall Owen", "Matthew Calderbank", "Mattias Rose",
                  "Mitchell Calleja", "Natalie Vienet", "Nickolas Reissis", "Nigel Judd", "Pablo Vilela",
                  "Peta Tobin", "Peter White", "Rebecca Ruck", "Rob Petrie", "Ruben Bock",
                  "Ryan McLean", "Sarah Nguyen", "Scott Milligan", "Shaun Albert", "Tracey Zamora"
              ],
              "akambo-paraplanning": [
                  "Aaron James", "Anthony Kapetanovic", "Brenton Ebinger", "Brylie Curran", "Chris Kapetanovic",
                  "David Pitt", "FIRST FINANCIAL PTY LTD", "Jane Zhou", "Jason Rawlins", "Lisa Palmer",
                  "Matthew Calderbank", "Nickolas Reissis", "Rob Petrie", "Welkin Admin"
              ],
              "akamboeventcalendar": ["FIRST FINANCIAL PTY LTD"],
              "akambofgcompliance": ["Chris Willaton", "Jane Zhou", "Welkin Admin"],
              "AkamboPortfolioInvestmentChanges": ["FIRST FINANCIAL PTY LTD"],
              "akamboprivatestaff": ["Ben Moyle", "Daniel Basic", "Nigel Judd"],
              "AkamboSharepoint": ["FIRST FINANCIAL PTY LTD"],
              "akambostaff": ["FIRST FINANCIAL PTY LTD"],
              "allcompany": ["FIRST FINANCIAL PTY LTD"],
              "AllCompany.3531329.vsiainou": ["FIRST FINANCIAL PTY LTD", "Welkin Admin"],
              "ALS": [
                  "Aashna Patel", "Abendigo Job Buena", "Avery Liu", "Avneet Dhindsa",
                  "FIRST FINANCIAL PTY LTD", "george", "George Katrantzis", "Ray Sabarillo", "Welkin Admin"
              ]
          };

          // Create reverse mapping for user access
          const userAccess = {};
          Object.keys(siteAccess).forEach(siteName => {
              siteAccess[siteName].forEach(userName => {
                  if (!userAccess[userName]) {
                      userAccess[userName] = [];
                  }
                  userAccess[userName].push(siteName);
              });
          });

          // Variables for highlighting and notes
          let highlightMode = null;
          let addNoteMode = false;
          let noteIdCounter = 0;
          let notes = [];
          let selectedElement = null;
          let notesVisible = true;

          // Initialize the tabs for site view
          function initSiteTabs() {
              const tabsContainer = document.getElementById('siteTabsContainer');
              const tabContents = document.getElementById('siteTabContents');

              // Clear existing content
              tabsContainer.innerHTML = '';
              tabContents.innerHTML = '';

              // Sort site names alphabetically
              const siteNames = Object.keys(siteAccess).sort();

              siteNames.forEach((siteName, index) => {
                  // Create tab button
                  const tabButton = document.createElement('button');
                  tabButton.className = 'tab-button';
                  tabButton.id = `site-tab-${index}`;
                  tabButton.textContent = siteName;
                  tabButton.onclick = function() { openSiteTab(index); };
                  tabButton.addEventListener('click', function(e) {
                      if (addNoteMode) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  });
                  tabsContainer.appendChild(tabButton);

                  // Create tab content
                  const tabContent = document.createElement('div');
                  tabContent.className = 'tab-content';
                  tabContent.id = `site-content-${index}`;
                  tabContent.addEventListener('click', function(e) {
                      if (addNoteMode && e.target === this) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  });

                  // Add site name as header
                  const siteHeader = document.createElement('h2');
                  siteHeader.textContent = siteName;
                  siteHeader.addEventListener('click', function(e) {
                      if (addNoteMode) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  });
                  tabContent.appendChild(siteHeader);

                  // Add count of users
                  const userCount = document.createElement('p');
                  userCount.innerHTML = `<strong>${siteAccess[siteName].length}</strong> users have access to this site`;
                  userCount.addEventListener('click', function(e) {
                      if (addNoteMode) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  });
                  tabContent.appendChild(userCount);

                  // Add user list
                  const userList = document.createElement('div');
                  userList.className = 'user-list';
                  userList.addEventListener('click', function(e) {
                      if (addNoteMode && e.target === this) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  });

                  siteAccess[siteName].sort().forEach(user => {
                      const userItem = document.createElement('div');
                      userItem.className = 'user-item';
                      userItem.textContent = user;
                      userItem.onclick = function(e) {
                          if (highlightMode) {
                              toggleHighlight(this, highlightMode);
                              e.stopPropagation();
                          } else if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          } else {
                              showUserDetails(user);
                          }
                      };
                      userList.appendChild(userItem);
                  });

                  tabContent.appendChild(userList);
                  tabContents.appendChild(tabContent);
              });

              // Open the first tab by default
              if (siteNames.length > 0) {
                  openSiteTab(0);
              }
          }

          // Initialize the tabs for user view
          function initUserTabs() {
              const tabsContainer = document.getElementById('userTabsContainer');
              const tabContents = document.getElementById('userTabContents');

              // Clear existing content
              tabsContainer.innerHTML = '';
              tabContents.innerHTML = '';

              // Create alphabetical index tabs for users (A-Z)
              const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
              const usersByLetter = {};

              // Initialize usersByLetter with empty arrays for each letter
              alphabet.forEach(letter => {
                  usersByLetter[letter] = [];
              });

              // Sort users into their respective letter groups
              Object.keys(userAccess).sort().forEach(userName => {
                  const firstLetter = userName.charAt(0).toUpperCase();
                  if (alphabet.includes(firstLetter)) {
                      usersByLetter[firstLetter].push(userName);
                  }
              });

              // Create tabs for each letter that has users
              alphabet.forEach((letter, index) => {
                  if (usersByLetter[letter].length > 0) {
                      // Create tab button
                      const tabButton = document.createElement('button');
                      tabButton.className = 'tab-button';
                      tabButton.id = `user-tab-${letter}`;
                      tabButton.textContent = letter;
                      tabButton.onclick = function() { openUserTab(letter); };
                      tabButton.addEventListener('click', function(e) {
                          if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });
                      tabsContainer.appendChild(tabButton);

                      // Create tab content
                      const tabContent = document.createElement('div');
                      tabContent.className = 'tab-content';
                      tabContent.id = `user-content-${letter}`;
                      tabContent.addEventListener('click', function(e) {
                          if (addNoteMode && e.target === this) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });

                      // Add letter as header
                      const letterHeader = document.createElement('h2');
                      letterHeader.textContent = `Users starting with ${letter}`;
                      letterHeader.addEventListener('click', function(e) {
                          if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });
                      tabContent.appendChild(letterHeader);

                      // Add count of users
                      const userCount = document.createElement('p');
                      userCount.innerHTML = `<strong>${usersByLetter[letter].length}</strong> users starting with ${letter}`;
                      userCount.addEventListener('click', function(e) {
                          if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });
                      tabContent.appendChild(userCount);

                      // Add user list
                      const userList = document.createElement('div');
                      userList.className = 'user-list';
                      userList.addEventListener('click', function(e) {
                          if (addNoteMode && e.target === this) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });

                      usersByLetter[letter].forEach(user => {
                          const userItem = document.createElement('div');
                          userItem.className = 'user-item';
                          userItem.textContent = user;
                          userItem.onclick = function(e) {
                              if (highlightMode) {
                                  toggleHighlight(this, highlightMode);
                                  e.stopPropagation();
                              } else if (addNoteMode) {
                                  addNoteToElement(this);
                                  e.stopPropagation();
                              } else {
                                  showUserDetails(user);
                              }
                          };
                          userList.appendChild(userItem);
                      });

                      tabContent.appendChild(userList);
                      tabContents.appendChild(tabContent);
                  }
              });

              // Open the first tab that has users
              for (const letter of alphabet) {
                  if (usersByLetter[letter].length > 0) {
                      openUserTab(letter);
                      break;
                  }
              }
          }

          // Function to open a specific site tab
          function openSiteTab(tabIndex) {
              // Hide all tab contents
              const tabContents = document.querySelectorAll('#siteTabContents .tab-content');
              for (let i = 0; i < tabContents.length; i++) {
                  tabContents[i].style.display = 'none';
              }

              // Remove active class from all tab buttons
              const tabButtons = document.querySelectorAll('#siteTabsContainer .tab-button');
              for (let i = 0; i < tabButtons.length; i++) {
                  tabButtons[i].className = tabButtons[i].className.replace(' active', '');
              }

              // Show the selected tab content and set the button as active
              document.getElementById(`site-content-${tabIndex}`).style.display = 'block';
              document.getElementById(`site-tab-${tabIndex}`).className += ' active';
          }

          // Function to open a specific user tab
          function openUserTab(letter) {
              // Hide all tab contents
              const tabContents = document.querySelectorAll('#userTabContents .tab-content');
              for (let i = 0; i < tabContents.length; i++) {
                  tabContents[i].style.display = 'none';
              }

              // Remove active class from all tab buttons
              const tabButtons = document.querySelectorAll('#userTabsContainer .tab-button');
              for (let i = 0; i < tabButtons.length; i++) {
                  tabButtons[i].className = tabButtons[i].className.replace(' active', '');
              }

              // Show the selected tab content and set the button as active
              document.getElementById(`user-content-${letter}`).style.display = 'block';
              document.getElementById(`user-tab-${letter}`).className += ' active';
          }

          // Function to show user details
          function showUserDetails(userName) {
              // Create modal and overlay
              const modal = document.createElement('div');
              modal.className = 'modal';
              modal.addEventListener('click', function(e) {
                  if (addNoteMode && e.target === this) {
                      addNoteToElement(this);
                      e.stopPropagation();
                  }
              });

              const overlay = document.createElement('div');
              overlay.className = 'overlay';
              overlay.onclick = function() {
                  document.body.removeChild(modal);
                  document.body.removeChild(overlay);
              };

              // Add the user name header
              const header = document.createElement('h2');
              header.textContent = `${userName}'s Access`;
              header.addEventListener('click', function(e) {
                  if (addNoteMode) {
                      addNoteToElement(this);
                      e.stopPropagation();
                  }
              });
              modal.appendChild(header);

              // Add count of sites
              const siteCount = document.createElement('p');
              const sites = userAccess[userName] || [];
              siteCount.innerHTML = `<strong>${sites.length}</strong> sites accessible by this user`;
              siteCount.addEventListener('click', function(e) {
                  if (addNoteMode) {
                      addNoteToElement(this);
                      e.stopPropagation();
                  }
              });
              modal.appendChild(siteCount);

              // Add site list
              const siteList = document.createElement('div');
              siteList.className = 'site-list';
              siteList.addEventListener('click', function(e) {
                  if (addNoteMode && e.target === this) {
                      addNoteToElement(this);
                      e.stopPropagation();
                  }
              });

              sites.sort().forEach(site => {
                  const siteItem = document.createElement('div');
                  siteItem.className = 'site-item';
                  siteItem.textContent = site;
                  siteItem.onclick = function(e) {
                      if (highlightMode) {
                          toggleHighlight(this, highlightMode);
                          e.stopPropagation();
                      } else if (addNoteMode) {
                          addNoteToElement(this);
                          e.stopPropagation();
                      }
                  };
                  siteList.appendChild(siteItem);
              });

              modal.appendChild(siteList);

              // Add close button
              const closeButton = document.createElement('button');
              closeButton.className = 'close-button';
              closeButton.textContent = 'Close';
              closeButton.onclick = function() {
                  document.body.removeChild(modal);
                  document.body.removeChild(overlay);
              };
              modal.appendChild(closeButton);

              // Add to body
              document.body.appendChild(overlay);
              document.body.appendChild(modal);
          }

          // Function to search for sites and users
          function searchSitesAndUsers() {
              const searchInput = document.getElementById('searchInput');
              const searchTerm = searchInput.value.toLowerCase();

              // Get the active view
              const activeView = document.querySelector('.view-button.active').id;

              if (activeView === 'siteViewButton') {
                  searchSiteView(searchTerm);
              } else {
                  searchUserView(searchTerm);
              }
          }

          // Function to search in site view
          function searchSiteView(searchTerm) {
              const tabButtons = document.querySelectorAll('#siteTabsContainer .tab-button');

              // If search term is empty, show all tabs
              if (searchTerm === '') {
                  for (let i = 0; i < tabButtons.length; i++) {
                      tabButtons[i].style.display = 'block';
                  }
                  return;
              }

              // Hide all tabs first
              for (let i = 0; i < tabButtons.length; i++) {
                  tabButtons[i].style.display = 'none';
              }

              // Show tabs that match the search term (site name or contains users matching the term)
              Object.keys(siteAccess).forEach((siteName, index) => {
                  const siteNameLower = siteName.toLowerCase();
                  const hasMatchingUsers = siteAccess[siteName].some(user =>
                      user.toLowerCase().includes(searchTerm)
                  );

                  if (siteNameLower.includes(searchTerm) || hasMatchingUsers) {
                      document.getElementById(`site-tab-${index}`).style.display = 'block';

                      // If we're searching, also filter users within that site's content
                      if (hasMatchingUsers) {
                          const userItems = document.querySelectorAll(`#site-content-${index} .user-item`);
                          userItems.forEach(item => {
                              if (item.textContent.toLowerCase().includes(searchTerm)) {
                                  item.style.display = 'block';
                                  item.style.fontWeight = 'bold';
                                  item.style.color = '#003366';
                              } else {
                                  item.style.display = 'none';
                              }
                          });
                      }
                  }
              });

              // Open the first visible tab
              for (let i = 0; i < tabButtons.length; i++) {
                  if (tabButtons[i].style.display !== 'none') {
                      const tabIndex = tabButtons[i].id.replace('site-tab-', '');
                      openSiteTab(parseInt(tabIndex));
                      break;
                  }
              }
          }

          // Function to search in user view
          function searchUserView(searchTerm) {
              const tabButtons = document.querySelectorAll('#userTabsContainer .tab-button');

              // If search term is empty, show all tabs
              if (searchTerm === '') {
                  for (let i = 0; i < tabButtons.length; i++) {
                      tabButtons[i].style.display = 'block';
                  }
                  return;
              }

              // If search term is short, search directly for users
              if (searchTerm.length >= 2) {
                  // Find matching users
                  const matchingUsers = Object.keys(userAccess).filter(userName =>
                      userName.toLowerCase().includes(searchTerm)
                  );

                  if (matchingUsers.length > 0) {
                      // Create a modal to show matching users
                      const modal = document.createElement('div');
                      modal.className = 'modal';
                      modal.addEventListener('click', function(e) {
                          if (addNoteMode && e.target === this) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });

                      const overlay = document.createElement('div');
                      overlay.className = 'overlay';
                      overlay.onclick = function() {
                          document.body.removeChild(modal);
                          document.body.removeChild(overlay);
                      };

                      // Add header
                      const header = document.createElement('h2');
                      header.textContent = `Search Results: "${searchTerm}"`;
                      header.addEventListener('click', function(e) {
                          if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });
                      modal.appendChild(header);

                      // Add count
                      const resultCount = document.createElement('p');
                      resultCount.innerHTML = `<strong>${matchingUsers.length}</strong> matching users found`;
                      resultCount.addEventListener('click', function(e) {
                          if (addNoteMode) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });
                      modal.appendChild(resultCount);

                      // Add user list
                      const userList = document.createElement('div');
                      userList.className = 'user-list';
                      userList.style.columnCount = '1'; // Force single column for better readability
                      userList.addEventListener('click', function(e) {
                          if (addNoteMode && e.target === this) {
                              addNoteToElement(this);
                              e.stopPropagation();
                          }
                      });

                      matchingUsers.sort().forEach(user => {
                          const userItem = document.createElement('div');
                          userItem.className = 'user-item';
                          userItem.textContent = user;
                          userItem.onclick = function(e) {
                              if (highlightMode) {
                                  toggleHighlight(this, highlightMode);
                                  e.stopPropagation();
                              } else if (addNoteMode) {
                                  addNoteToElement(this);
                                  e.stopPropagation();
                              } else {
                                  document.body.removeChild(modal);
                                  document.body.removeChild(overlay);
                                  showUserDetails(user);
                              }
                          };
                          userList.appendChild(userItem);
                      });

                      modal.appendChild(userList);

                      // Add close button
                      const closeButton = document.createElement('button');
                      closeButton.className = 'close-button';
                      closeButton.textContent = 'Close';
                      closeButton.onclick = function() {
                          document.body.removeChild(modal);
                          document.body.removeChild(overlay);
                      };
                      modal.appendChild(closeButton);

                      // Add to body
                      document.body.appendChild(overlay);
                      document.body.appendChild(modal);
                  } else {
                      alert(`No users found matching "${searchTerm}".`);
                  }
              } else {
                  // For very short search terms, just filter the tabs
                  // Hide all tabs first
                  for (let i = 0; i < tabButtons.length; i++) {
                      tabButtons[i].style.display = 'none';
                  }

                  // Show tabs that match the first letter of the search term
                  const firstLetter = searchTerm.charAt(0).toUpperCase();
                  if (document.getElementById(`user-tab-${firstLetter}`)) {
                      document.getElementById(`user-tab-${firstLetter}`).style.display = 'block';
                      openUserTab(firstLetter);

                      // Also filter users within that tab's content
                      const userItems = document.querySelectorAll(`#user-content-${firstLetter} .user-item`);
                      userItems.forEach(item => {
                          if (item.textContent.toLowerCase().includes(searchTerm)) {
                              item.style.display = 'block';
                              item.style.fontWeight = 'bold';
                              item.style.color = '#003366';
                          } else {
                              item.style.display = 'none';
                          }
                      });
                  } else {
                      alert(`No users found starting with "${firstLetter}".`);
                  }
              }
          }

          // Function to reset view
          function resetView() {
              document.getElementById('searchInput').value = '';

              // Get the active view
              const activeView = document.querySelector('.view-button.active').id;

              if (activeView === 'siteViewButton') {
                  const tabButtons = document.querySelectorAll('#siteTabsContainer .tab-button');
                  const userItems = document.querySelectorAll('#siteTabContents .user-item');

                  // Show all tabs
                  for (let i = 0; i < tabButtons.length; i++) {
                      tabButtons[i].style.display = 'block';
                  }

                  // Show all user items and reset styling
                  for (let i = 0; i < userItems.length; i++) {
                      userItems[i].style.display = 'block';
                      if (!userItems[i].classList.contains('highlight-red-bg') &&
                          !userItems[i].classList.contains('highlight-yellow-bg')) {
                          userItems[i].style.fontWeight = 'normal';
                          userItems[i].style.color = '#333';
                      }
                  }

                  // Open the first tab
                  openSiteTab(0);
              } else {
                  const tabButtons = document.querySelectorAll('#userTabsContainer .tab-button');
                  const userItems = document.querySelectorAll('#userTabContents .user-item');

                  // Show all tabs
                  for (let i = 0; i < tabButtons.length; i++) {
                      tabButtons[i].style.display = 'block';
                  }

                  // Show all user items and reset styling
                  for (let i = 0; i < userItems.length; i++) {
                      userItems[i].style.display = 'block';
                      if (!userItems[i].classList.contains('highlight-red-bg') &&
                          !userItems[i].classList.contains('highlight-yellow-bg')) {
                          userItems[i].style.fontWeight = 'normal';
                          userItems[i].style.color = '#333';
                      }
                  }

                  // Open the first tab
                  openUserTab('A');
              }
          }

          // Toggle between site and user views
          document.getElementById('siteViewButton').addEventListener('click', function() {
              document.getElementById('siteViewButton').classList.add('active');
              document.getElementById('userViewButton').classList.remove('active');
              document.getElementById('siteViewContainer').style.display = 'block';
              document.getElementById('userViewContainer').style.display = 'none';
              document.getElementById('searchInput').placeholder = 'Search for sites...';
              resetView();
          });

          document.getElementById('userViewButton').addEventListener('click', function() {
              document.getElementById('userViewButton').classList.add('active');
              document.getElementById('siteViewButton').classList.remove('active');
              document.getElementById('userViewContainer').style.display = 'block';
              document.getElementById('siteViewContainer').style.display = 'none';
              document.getElementById('searchInput').placeholder = 'Search for users...';
              resetView();
          });

          // Add search functionality
          document.getElementById('searchInput').addEventListener('keyup', function() {
              searchSitesAndUsers();
          });

          // Set the highlight mode
          function setHighlightMode(mode) {
              if (highlightMode === mode) {
                  highlightMode = null;
                  document.body.style.cursor = 'default';
              } else {
                  highlightMode = mode;
                  addNoteMode = false;
                  document.body.style.cursor = 'pointer';
              }
          }

          // Toggle highlight for an element
          function toggleHighlight(element, mode) {
              if (mode === 'red') {
                  element.classList.toggle('highlight-red-bg');
                  element.classList.remove('highlight-yellow-bg');
              } else if (mode === 'yellow') {
                  element.classList.toggle('highlight-yellow-bg');
                  element.classList.remove('highlight-red-bg');
              } else if (mode === 'clear') {
                  element.classList.remove('highlight-red-bg');
                  element.classList.remove('highlight-yellow-bg');
              }
          }

          // Toggle add note mode
          function toggleAddNoteMode() {
              addNoteMode = !addNoteMode;
              if (addNoteMode) {
                  highlightMode = null;
                  document.body.style.cursor = 'crosshair';
              } else {
                  document.body.style.cursor = 'default';
              }
          }

          // Add a note to an element
          function addNoteToElement(element) {
              const noteId = 'note-' + noteIdCounter++;

              // Create note container
              const noteContainer = document.createElement('div');
              noteContainer.className = 'note-container';
              noteContainer.id = noteId;

              // Create textarea
              const textarea = document.createElement('textarea');
              textarea.className = 'note-textarea';
              textarea.placeholder = 'Add your note here...';

              // Create save button
              const saveButton = document.createElement('button');
              saveButton.className = 'close-button';
              saveButton.textContent = 'Save Note';
              saveButton.style.marginRight = '5px';

              // Create cancel button
              const cancelButton = document.createElement('button');
              cancelButton.className = 'close-button';
              cancelButton.textContent = 'Cancel';
              cancelButton.style.background = '#f1f1f1';
              cancelButton.style.color = '#333';

              // Add buttons to note container
              noteContainer.appendChild(textarea);
              noteContainer.appendChild(saveButton);
              noteContainer.appendChild(cancelButton);

              // Add note container to element or as floating note
              if (element) {
                  if (element.tagName === 'DIV' && (element.classList.contains('user-item') ||
  element.classList.contains('site-item'))) {
                      element.style.position = 'relative';
                      element.appendChild(noteContainer);
                  } else {
                      createFloatingNote(textarea.value, {
                          x: Math.max(100, Math.random() * (window.innerWidth - 300)),
                          y: Math.max(100, Math.random() * (window.innerHeight - 300))
                      });
                      return;
                  }
              } else {
                  createFloatingNote(textarea.value, {
                      x: Math.max(100, Math.random() * (window.innerWidth - 300)),
                      y: Math.max(100, Math.random() * (window.innerHeight - 300))
                  });
                  return;
              }

              // Save note
              saveButton.onclick = function() {
                  if (textarea.value.trim() !== '') {
                      // If the element is a user-item or site-item, add a note icon
                      if (element.tagName === 'DIV' && (element.classList.contains('user-item') ||
  element.classList.contains('site-item'))) {
                          element.removeChild(noteContainer);

                          // Add note icon
                          const noteIcon = document.createElement('span');
                          noteIcon.className = 'note-icon';
                          noteIcon.title = textarea.value;
                          noteIcon.onclick = function(e) {
                              e.stopPropagation();
                              alert(textarea.value);
                          };
                          element.appendChild(noteIcon);

                          // Store note
                          notes.push({
                              id: noteId,
                              text: textarea.value,
                              element: element,
                              icon: noteIcon
                          });
                      } else {
                          element.removeChild(noteContainer);
                          createFloatingNote(textarea.value, {
                              x: Math.max(100, Math.random() * (window.innerWidth - 300)),
                              y: Math.max(100, Math.random() * (window.innerHeight - 300))
                          });
                      }
                  } else {
                      element.removeChild(noteContainer);
                  }
                  addNoteMode = false;
                  document.body.style.cursor = 'default';
              };

              // Cancel note
              cancelButton.onclick = function() {
                  element.removeChild(noteContainer);
                  addNoteMode = false;
                  document.body.style.cursor = 'default';
              };

              // Focus textarea
              textarea.focus();
          }

          // Create a floating note
          function createFloatingNote(text, position) {
              const noteId = 'float-note-' + noteIdCounter++;

              // Create floating note
              const floatingNote = document.createElement('div');
              floatingNote.className = 'floating-note';
              floatingNote.id = noteId;
              floatingNote.style.left = position.x + 'px';
              floatingNote.style.top = position.y + 'px';

              // Create header
              const header = document.createElement('div');
              header.className = 'floating-note-header';

              // Create title
              const title = document.createElement('span');
              title.textContent = 'Note';

              // Create close button
              const closeButton = document.createElement('span');
              closeButton.className = 'note-close';
              closeButton.textContent = '×';
              closeButton.onclick = function() {
                  document.body.removeChild(floatingNote);
                  notes = notes.filter(note => note.id !== noteId);
              };

              // Add title and close button to header
              header.appendChild(title);
              header.appendChild(closeButton);

              // Create content
              const content = document.createElement('div');
              content.className = 'note-content';
              content.contentEditable = true;
              content.textContent = text || '';

              // Add header and content to floating note
              floatingNote.appendChild(header);
              floatingNote.appendChild(content);

              // Add to body
              document.body.appendChild(floatingNote);

              // Make draggable
              makeElementDraggable(floatingNote, header);

              // Store note
              notes.push({
                  id: noteId,
                  text: text || '',
                  floatingNote: floatingNote
              });

              // Focus content
              if (!text) {
                  content.focus();
              }

              return floatingNote;
          }

          // Make an element draggable
          function makeElementDraggable(element, handle) {
              let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

              handle.onmousedown = dragMouseDown;

              function dragMouseDown(e) {
                  e.preventDefault();
                  // Get the mouse cursor position at startup
                  pos3 = e.clientX;
                  pos4 = e.clientY;
                  document.onmouseup = closeDragElement;
                  // Call a function whenever the cursor moves
                  document.onmousemove = elementDrag;

                  // Bring to front
                  element.style.zIndex = 1000;
              }

              function elementDrag(e) {
                  e.preventDefault();
                  // Calculate the new cursor position
                  pos1 = pos3 - e.clientX;
                  pos2 = pos4 - e.clientY;
                  pos3 = e.clientX;
                  pos4 = e.clientY;
                  // Set the element's new position
                  element.style.top = (element.offsetTop - pos2) + "px";
                  element.style.left = (element.offsetLeft - pos1) + "px";
              }

              function closeDragElement() {
                  // Stop moving when mouse button is released
                  document.onmouseup = null;
                  document.onmousemove = null;
              }
          }

          // Toggle display of all notes
          function toggleAllNotes() {
              notesVisible = !notesVisible;

              notes.forEach(note => {
                  if (note.floatingNote) {
                      note.floatingNote.style.display = notesVisible ? 'block' : 'none';
                  }
                  if (note.icon) {
                      note.icon.style.display = notesVisible ? 'inline-block' : 'none';
                  }
              });
          }

          // Add floating note button event
          document.getElementById('annotationButton').addEventListener('click', function() {
              createFloatingNote('', {
                  x: Math.max(100, Math.random() * (window.innerWidth - 300)),
                  y: Math.max(100, Math.random() * (window.innerHeight - 300))
              });
          });

          // Initialize the site tabs and user tabs when the page loads
          window.onload = function() {
              initSiteTabs();
              initUserTabs();
          };
      </script>
  </body>
  </html>
